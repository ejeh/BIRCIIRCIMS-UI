<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kindred Head Dashboard - GovID System</title>

    <link
      rel="icon"
      type="image/png"
      href="/assets/images/benue-state-logo.png"
      sizes="16x16"
    />

    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
    />
    <!-- DataTables CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css"
    />
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Animate.css -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css"
    />

    <style>
      :root {
        --sidebar-width: 260px;
        --sidebar-bg: #1a1d29;
        --sidebar-text: #a0a9c9;
        --sidebar-active: #4c5fd5;
        --header-height: 60px;
        --header-bg: #ffffff;
        --main-bg: #f5f6fa;
        --card-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
        --primary-color: #4c5fd5;
        --success-color: #10b981;
        --warning-color: #f59e0b;
        --danger-color: #ef4444;
        --info-color: #3b82f6;
      }

      [data-theme="dark"] {
        --sidebar-bg: #0f0f14;
        --sidebar-text: #8892b0;
        --sidebar-active: #6366f1;
        --header-bg: #1a1d29;
        --main-bg: #111318;
        --card-bg: #1a1d29;
        --text-color: #e6e6e6;
        --border-color: #2a2d3a;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background-color: var(--main-bg);
        color: var(--text-color);
        transition: all 0.3s ease;
      }

      /* Sidebar Styles */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: var(--sidebar-width);
        background-color: var(--sidebar-bg);
        z-index: 1000;
        transition: all 0.3s ease;
        overflow-y: auto;
      }

      .sidebar-header {
        padding: 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .sidebar-menu {
        padding: 20px 0;
      }

      .sidebar-menu .nav-link {
        color: var(--sidebar-text);
        padding: 12px 20px;
        display: flex;
        align-items: center;
        transition: all 0.3s ease;
        border-radius: 0;
      }

      .sidebar-menu .nav-link:hover {
        background-color: rgba(255, 255, 255, 0.05);
        color: #fff;
      }

      .sidebar-menu .nav-link.active {
        background-color: var(--sidebar-active);
        color: #fff;
      }

      .sidebar-menu .nav-link i {
        margin-right: 10px;
        font-size: 18px;
      }

      .sidebar-menu .nav-link .badge {
        margin-left: auto;
      }

      /* Header Styles */
      .header {
        position: fixed;
        top: 0;
        left: var(--sidebar-width);
        right: 0;
        height: var(--header-height);
        background-color: var(--header-bg);
        z-index: 999;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        display: flex;
        align-items: center;
        padding: 0 20px;
        transition: all 0.3s ease;
      }

      .header .search-bar {
        flex: 1;
        max-width: 400px;
      }

      .header .header-actions {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      /* Main Content */
      .main-content {
        margin-left: var(--sidebar-width);
        margin-top: var(--header-height);
        padding: 20px;
        min-height: calc(100vh - var(--header-height));
        transition: all 0.3s ease;
      }

      /* Card Styles */
      .card {
        border: none;
        border-radius: 10px;
        box-shadow: var(--card-shadow);
        margin-bottom: 20px;
        background-color: var(--card-bg);
        transition: all 0.3s ease;
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      }

      .card-header {
        background-color: transparent;
        border-bottom: 1px solid var(--border-color);
        padding: 15px 20px;
        font-weight: 600;
      }

      .card-body {
        padding: 20px;
      }

      /* Profile Photo Upload */
      .profile-photo-container {
        position: relative;
        width: 150px;
        height: 150px;
        margin: 0 auto 20px;
      }

      .profile-photo {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        object-fit: cover;
        border: 4px solid var(--primary-color);
      }
      .profile-avatar {
        width: 40px;
        height: 40px;
        object-fit: cover;
      }

      .profile-photo-upload {
        position: absolute;
        bottom: 0;
        right: 0;
        background-color: var(--primary-color);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .profile-photo-upload:hover {
        background-color: #3b4cdb;
      }

      /* Profile Completion Bar */
      .profile-completion {
        margin-bottom: 20px;
      }

      .progress {
        height: 10px;
        border-radius: 5px;
      }

      /* Status Badge */
      .status-badge {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 600;
      }

      .status-badge.approved {
        background-color: #10b981;
        color: white;
      }

      .status-badge.pending {
        background-color: #f59e0b;
        color: white;
      }

      .status-badge.rejected {
        background-color: #ef4444;
      }

      .status-badge.verified {
        background-color: var(--success-color);
        color: white;
      }

      .status-badge.unverified {
        background-color: var(--warning-color);
        color: white;
      }

      /* Dark Mode Toggle */
      .theme-toggle {
        position: relative;
        width: 50px;
        height: 26px;
        background-color: #ccc;
        border-radius: 34px;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      .theme-toggle.active {
        background-color: var(--primary-color);
      }

      .theme-toggle-slider {
        position: absolute;
        top: 3px;
        left: 3px;
        width: 20px;
        height: 20px;
        background-color: white;
        border-radius: 50%;
        transition: transform 0.3s;
      }

      .theme-toggle.active .theme-toggle-slider {
        transform: translateX(24px);
      }

      /* Two Factor Toggle */
      .form-switch .form-check-input {
        width: 50px;
        height: 26px;
        background-color: #ccc;
        border: none;
      }

      .form-switch .form-check-input:checked {
        background-color: var(--primary-color);
      }

      /* Responsive */
      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
        }

        .sidebar.show {
          transform: translateX(0);
        }

        .header {
          left: 0;
        }

        .main-content {
          margin-left: 0;
        }
      }

      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }

      ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #555;
      }

      /* Table Styles */
      .dataTables_wrapper .dataTables_filter input {
        border: 1px solid var(--border-color);
        border-radius: 5px;
        padding: 5px 10px;
      }

      .dataTables_wrapper .dataTables_length select {
        border: 1px solid var(--border-color);
        border-radius: 5px;
        padding: 5px;
      }

      /* Chart Container */
      .chart-container {
        position: relative;
        height: 300px;
        margin-bottom: 20px;
      }

      /* Activity Timeline */
      .activity-timeline {
        position: relative;
        padding-left: 30px;
      }

      .activity-timeline::before {
        content: "";
        position: absolute;
        left: 10px;
        top: 0;
        bottom: 0;
        width: 2px;
        background-color: var(--border-color);
      }

      .activity-item {
        position: relative;
        margin-bottom: 20px;
      }

      .activity-item::before {
        content: "";
        position: absolute;
        left: -24px;
        top: 5px;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background-color: var(--sidebar-active);
      }

      .activity-item .activity-time {
        font-size: 12px;
        color: var(--sidebar-text);
        margin-bottom: 5px;
      }

      .activity-item .activity-content {
        font-size: 14px;
      }

      /* Loading Spinner */
      .loading-spinner {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 9999;
        justify-content: center;
        align-items: center;
      }

      .loading-spinner.show {
        display: flex;
      }

      .spinner {
        width: 50px;
        height: 50px;
        border: 5px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: #fff;
        animation: spin 1s ease-in-out infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Export Buttons */
      .export-buttons {
        display: flex;
        gap: 5px;
      }

      .export-buttons button {
        padding: 5px 10px;
        font-size: 14px;
        border: 1px solid #ddd;
        background-color: #fff;
        border-radius: 4px;
        cursor: pointer;
      }

      .export-buttons button:hover {
        background-color: #f5f5f5;
      }

      /* Print Styles */
      @media print {
        .sidebar,
        .header,
        .btn-group,
        .dataTables_paginate,
        .dataTables_info,
        .dataTables_length,
        .dataTables_filter {
          display: none !important;
        }

        .main-content {
          margin-left: 0 !important;
          margin-top: 0 !important;
        }

        .card {
          break-inside: avoid;
        }
      }
    </style>
  </head>
  <body>
    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
      <div class="spinner"></div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="d-flex align-items-center">
          <img
            src="/assets/images/benue-state-logo.png"
            alt="Benue State Logo"
            class="me-3"
            width="40"
          />
          <div>
            <h4 class="mb-0 fw-bold text-white">BICRIRMS</h4>
            <small class="text-white" style="font-size: 0.8rem">
              Kindred Head Portal
            </small>
          </div>
        </div>
      </div>
      <nav class="sidebar-menu">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link active" href="#" data-page="dashboard">
              <i class="bi bi-speedometer2"></i>
              Dashboard Overview
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" data-page="certificates">
              <i class="bi bi-file-earmark-text"></i>
              Certificate Requests
              <span class="badge bg-warning" id="pendingCertificatesBadge"
                >0</span
              >
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" data-page="analytics">
              <i class="bi bi-graph-up"></i>
              Analytics
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" data-page="members">
              <i class="bi bi-people"></i>
              Kindred Members
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" data-page="activity">
              <i class="bi bi-clock-history"></i>
              Activity Logs
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" data-page="profile">
              <i class="bi bi-person-circle"></i>
              My Profile
              <span class="badge bg-info" id="profileCompletionBadge">0%</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" data-page="settings">
              <i class="bi bi-gear"></i>
              Settings
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- Header -->
    <header class="header">
      <button class="btn btn-light d-md-none me-3" id="sidebarToggle">
        <i class="bi bi-list"></i>
      </button>

      <div class="search-bar">
        <div class="input-group">
          <span class="input-group-text bg-transparent border-end-0">
            <i class="bi bi-search"></i>
          </span>
          <input
            type="text"
            class="form-control border-start-0"
            placeholder="Search certificates..."
            id="globalSearch"
          />
        </div>
      </div>

      <div class="header-actions">
        <div class="dropdown">
          <button
            class="btn btn-light position-relative"
            type="button"
            data-bs-toggle="dropdown"
            id="notificationDropdown"
          >
            <i class="bi bi-bell"></i>
            <span
              class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
              id="notificationBadge"
            >
              <span id="notificationCount">0</span>
            </span>
          </button>

          <ul
            class="dropdown-menu dropdown-menu-end p-0 shadow-sm"
            style="min-width: 300px; max-height: 400px; overflow-y: auto"
            id="notificationList"
          >
            <li>
              <h6 class="dropdown-header bg-light border-bottom">
                Notifications
              </h6>
            </li>
            <li id="notificationsContainer">
              <div
                class="text-center py-3 text-muted small"
                id="noNotifications"
              >
                No new notifications
              </div>
            </li>
            <li><hr class="dropdown-divider" /></li>
            <li>
              <a
                class="dropdown-item text-center fw-bold text-primary"
                href="#"
                id="viewAllNotifications"
              >
                View all notifications
              </a>
            </li>
          </ul>
        </div>

        <div class="dropdown">
          <button
            class="btn btn-light d-flex align-items-center"
            type="button"
            data-bs-toggle="dropdown"
          >
            <img
              id="userProfilePic"
              src="https://picsum.photos/seed/kindredhead/40/40.jpg"
              class="rounded-circle me-2 img-fluid profile-avatar"
              alt="User"
              style="width: 40px; height: 40px; object-fit: cover"
            />
            <span id="currentUser">Kindred Head</span>
          </button>
          <ul class="dropdown-menu">
            <li>
              <a class="dropdown-item" href="#" data-page="profile"
                ><i class="bi bi-person me-2"></i>My Profile</a
              >
            </li>
            <li>
              <a class="dropdown-item" href="#" data-page="settings"
                ><i class="bi bi-gear me-2"></i>Settings</a
              >
            </li>
            <li><hr class="dropdown-divider" /></li>
            <li>
              <a class="dropdown-item" href="#" id="logoutBtn"
                ><i class="bi bi-box-arrow-right me-2"></i>Logout</a
              >
            </li>
          </ul>
        </div>

        <div class="theme-toggle" id="themeToggle">
          <div class="theme-toggle-slider"></div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Dashboard Page -->
      <div id="dashboard-page" class="page-content">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="mb-0">Kindred Head Dashboard</h2>
          <div>
            <button class="btn btn-primary me-2" id="refreshDashboard">
              <i class="bi bi-arrow-clockwise me-2"></i>Refresh
            </button>
          </div>
        </div>

        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">
              Dashboard
            </li>
          </ol>
        </nav>

        <!-- Summary Cards -->
        <div class="row mb-4">
          <div class="col-xl-3 col-md-6 mb-3">
            <div class="card animate__animated animate__fadeInUp">
              <div class="card-body text-center">
                <i class="bi bi-people-fill text-primary fs-2 mb-2"></i>
                <h3 class="text-primary" id="totalMembersCard">0</h3>
                <p class="mb-0">Total Members in Kindred</p>
              </div>
            </div>
          </div>
          <div class="col-xl-3 col-md-6 mb-3">
            <div
              class="card animate__animated animate__fadeInUp"
              style="animation-delay: 0.1s"
            >
              <div class="card-body text-center">
                <i class="bi bi-file-earmark-text-fill text-info fs-2 mb-2"></i>
                <h3 class="text-info" id="totalCertificatesCard">0</h3>
                <p class="mb-0">Total Certificate Requests</p>
              </div>
            </div>
          </div>
          <div class="col-xl-3 col-md-6 mb-3">
            <div
              class="card animate__animated animate__fadeInUp"
              style="animation-delay: 0.2s"
            >
              <div class="card-body text-center">
                <i class="bi bi-clock-fill text-warning fs-2 mb-2"></i>
                <h3 class="text-warning" id="pendingCertificatesCard">0</h3>
                <p class="mb-0">Pending Requests</p>
              </div>
            </div>
          </div>
          <div class="col-xl-3 col-md-6 mb-3">
            <div
              class="card animate__animated animate__fadeInUp"
              style="animation-delay: 0.3s"
            >
              <div class="card-body text-center">
                <i class="bi bi-check-circle-fill text-success fs-2 mb-2"></i>
                <h3 class="text-success" id="approvedCertificatesCard">0</h3>
                <p class="mb-0">Approved Requests</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Charts Row -->
        <div class="row mb-4">
          <div class="col-lg-6 mb-3">
            <div class="card animate__animated animate__fadeInLeft">
              <div class="card-header">
                <h5 class="mb-0">Certificate Requests by Status</h5>
              </div>
              <div class="card-body">
                <div class="chart-container">
                  <canvas id="requestStatusChart"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-6 mb-3">
            <div class="card animate__animated animate__fadeInRight">
              <div class="card-header">
                <h5 class="mb-0">Requests by Day of Week</h5>
              </div>
              <div class="card-body">
                <div class="chart-container">
                  <canvas id="requestFrequencyChart"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Top LGAs and Recent Activity -->
        <div class="row mb-4">
          <div class="col-lg-6 mb-3">
            <div class="card animate__animated animate__fadeInLeft">
              <div class="card-header">
                <h5 class="mb-0">Top Active LGAs</h5>
              </div>
              <div class="card-body">
                <div class="chart-container">
                  <canvas id="topLGAsChart"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-6 mb-3">
            <div class="card animate__animated animate__fadeInRight">
              <div class="card-header">
                <h5 class="mb-0">Recent Activity</h5>
              </div>
              <div class="card-body">
                <div class="activity-timeline" id="activityTimeline">
                  <!-- Activity items will be populated by JavaScript -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Profile Completion Card -->
        <div class="row">
          <div class="col-12">
            <div class="card animate__animated animate__fadeInUp">
              <div class="card-header">
                <h5 class="mb-0">Profile Completion</h5>
              </div>
              <div class="card-body">
                <div class="profile-completion">
                  <div
                    class="d-flex justify-content-between align-items-center mb-2"
                  >
                    <h5>Your Profile Completion</h5>
                    <span id="profileCompletionText">0%</span>
                  </div>
                  <div class="progress">
                    <div
                      class="progress-bar bg-success"
                      id="profileCompletionBar"
                      role="progressbar"
                      style="width: 0%"
                    ></div>
                  </div>
                  <div class="mt-2">
                    <small class="text-muted"
                      >Complete your profile to access all features</small
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Certificate Requests Page -->
      <div id="certificates-page" class="page-content d-none">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="mb-0">Certificate Requests</h2>
          <div>
            <button
              class="btn btn-outline-primary me-2"
              id="exportCertificates"
            >
              <i class="bi bi-download me-2"></i>Export
            </button>
            <button class="btn btn-primary" id="refreshCertificates">
              <i class="bi bi-arrow-clockwise me-2"></i>Refresh
            </button>
          </div>
        </div>

        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">
              Certificate Requests
            </li>
          </ol>
        </nav>

        <!-- Filter Tabs -->
        <ul class="nav nav-tabs mb-4" id="certificateTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button
              class="nav-link active"
              id="all-tab"
              data-bs-toggle="tab"
              data-bs-target="#all"
              type="button"
              role="tab"
            >
              All Requests
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="pending-tab"
              data-bs-toggle="tab"
              data-bs-target="#pending"
              type="button"
              role="tab"
            >
              Pending
              <span class="badge bg-warning ms-1" id="pendingCount">0</span>
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="approved-tab"
              data-bs-toggle="tab"
              data-bs-target="#approved"
              type="button"
              role="tab"
            >
              Approved
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="rejected-tab"
              data-bs-toggle="tab"
              data-bs-target="#rejected"
              type="button"
              role="tab"
            >
              Rejected
            </button>
          </li>
        </ul>

        <div class="tab-content" id="certificateTabsContent">
          <!-- All Requests -->
          <div class="tab-pane fade show active" id="all" role="tabpanel">
            <div class="card">
              <div class="card-body">
                <table
                  id="allCertificatesTable"
                  class="table table-striped table-hover w-100"
                >
                  <thead>
                    <tr>
                      <th>Request ID</th>
                      <th>Applicant Name</th>
                      <th>NIN</th>
                      <th>Phone</th>
                      <th>Request Date</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Table data will be populated by JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Pending Requests -->
          <div class="tab-pane fade" id="pending" role="tabpanel">
            <div class="card">
              <div class="card-body">
                <table
                  id="pendingCertificatesTable"
                  class="table table-striped table-hover w-100"
                >
                  <thead>
                    <tr>
                      <th>Request ID</th>
                      <th>Applicant Name</th>
                      <th>NIN</th>
                      <th>Phone</th>
                      <th>Request Date</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Table data will be populated by JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Approved Requests -->
          <div class="tab-pane fade" id="approved" role="tabpanel">
            <div class="card">
              <div class="card-body">
                <table
                  id="approvedCertificatesTable"
                  class="table table-striped table-hover w-100"
                >
                  <thead>
                    <tr>
                      <th>Request ID</th>
                      <th>Applicant Name</th>
                      <th>NIN</th>
                      <th>Phone</th>
                      <th>Request Date</th>
                      <th>Approval Date</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Table data will be populated by JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Rejected Requests -->
          <div class="tab-pane fade" id="rejected" role="tabpanel">
            <div class="card">
              <div class="card-body">
                <table
                  id="rejectedCertificatesTable"
                  class="table table-striped table-hover w-100"
                >
                  <thead>
                    <tr>
                      <th>Request ID</th>
                      <th>Applicant Name</th>
                      <th>NIN</th>
                      <th>Phone</th>
                      <th>Request Date</th>
                      <th>Rejection Date</th>
                      <th>Reason</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Table data will be populated by JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Analytics Page -->
      <div id="analytics-page" class="page-content d-none">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="mb-0">Analytics</h2>
          <div>
            <button class="btn btn-outline-primary me-2" id="dateRange">
              <i class="bi bi-calendar3 me-2"></i>Date Range
            </button>
            <button class="btn btn-primary" id="refreshAnalytics">
              <i class="bi bi-arrow-clockwise me-2"></i>Refresh
            </button>
          </div>
        </div>

        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">
              Analytics
            </li>
          </ol>
        </nav>

        <!-- Analytics Charts -->
        <div class="row mb-4">
          <div class="col-lg-6 mb-3">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0">Certificate Requests Trend</h5>
              </div>
              <div class="card-body">
                <div class="chart-container">
                  <canvas id="certificateTrendChart"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-6 mb-3">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0">Approval Rate</h5>
              </div>
              <div class="card-body">
                <div class="chart-container">
                  <canvas id="approvalRateChart"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row mb-4">
          <div class="col-lg-6 mb-3">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0">Requests by Kindred</h5>
              </div>
              <div class="card-body">
                <div class="chart-container">
                  <canvas id="requestsByKindredChart"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-6 mb-3">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0">Request Processing Time</h5>
              </div>
              <div class="card-body">
                <div class="chart-container">
                  <canvas id="processingTimeChart"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Members Page -->
      <div id="members-page" class="page-content d-none">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="mb-0">Kindred Members</h2>
          <div>
            <button class="btn btn-outline-primary me-2" id="exportMembers">
              <i class="bi bi-download me-2"></i>Export
            </button>
            <button class="btn btn-primary" id="refreshMembers">
              <i class="bi bi-arrow-clockwise me-2"></i>Refresh
            </button>
          </div>
        </div>

        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">
              Kindred Members
            </li>
          </ol>
        </nav>

        <div class="card">
          <div class="card-body">
            <table
              id="membersTable"
              class="table table-striped table-hover w-100"
            >
              <thead>
                <tr>
                  <th>Name</th>
                  <th>NIN</th>
                  <th>Phone</th>
                  <th>Email</th>
                  <th>Address</th>
                  <th>Registration Date</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Table data will be populated by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Activity Logs Page -->
      <div id="activity-page" class="page-content d-none">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="mb-0">Activity Logs</h2>
          <div>
            <button class="btn btn-outline-primary me-2" id="filterActivity">
              <i class="bi bi-funnel me-2"></i>Filter
            </button>
            <button class="btn btn-primary" id="refreshActivity">
              <i class="bi bi-arrow-clockwise me-2"></i>Refresh
            </button>
          </div>
        </div>

        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">
              Activity Logs
            </li>
          </ol>
        </nav>

        <div class="card">
          <div class="card-body">
            <div class="activity-timeline" id="fullActivityTimeline">
              <!-- Activity items will be populated by JavaScript -->
            </div>
          </div>
        </div>
      </div>

      <!-- Profile Page -->
      <div id="profile-page" class="page-content d-none">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="mb-0">My Profile</h2>
          <button class="btn btn-primary" id="saveProfileBtn">
            <i class="bi bi-check-circle me-2"></i>Save Changes
          </button>
        </div>

        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">
              My Profile
            </li>
          </ol>
        </nav>

        <!-- Profile Photo and Completion -->
        <div class="card mb-4">
          <div class="card-body">
            <div class="row">
              <div class="col-md-4 text-center">
                <div class="profile-photo-container">
                  <img
                    src="https://picsum.photos/seed/kindredhead/150/150.jpg"
                    class="profile-photo"
                    id="profilePhotoImg"
                    alt="Profile"
                  />
                  <div class="profile-photo-upload" id="profilePhotoUpload">
                    <i class="bi bi-camera"></i>
                  </div>
                  <input
                    type="file"
                    id="profilePhotoInput"
                    accept="image/*"
                    style="display: none"
                  />
                </div>
                <div
                  class="progress mt-3"
                  id="uploadProgress"
                  style="display: none"
                >
                  <div
                    class="progress-bar"
                    role="progressbar"
                    style="width: 0%"
                  ></div>
                </div>
              </div>
              <div class="col-md-8">
                <div class="profile-completion">
                  <div
                    class="d-flex justify-content-between align-items-center mb-2"
                  >
                    <h5>Profile Completion</h5>
                    <span id="profileCompletionText">0%</span>
                  </div>
                  <div class="progress">
                    <div
                      class="progress-bar bg-success"
                      id="profileCompletionBar"
                      role="progressbar"
                      style="width: 0%"
                    ></div>
                  </div>
                  <div class="mt-2">
                    <span class="status-badge" id="verificationStatus"
                      >Verified</span
                    >
                    <span class="status-badge ms-2" id="profileStatus"
                      >Complete</span
                    >
                  </div>
                </div>

                <div class="mt-4">
                  <h5>Account Security</h5>
                  <div class="d-flex align-items-center mt-2">
                    <span class="me-3">Two-Factor Authentication:</span>
                    <div class="form-check form-switch">
                      <input
                        class="form-check-input"
                        type="checkbox"
                        id="twoFactorToggle"
                      />
                      <label class="form-check-label" for="twoFactorToggle">
                        <span id="twoFactorStatus">Disabled</span>
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Personal Information -->
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="mb-0">Personal Information</h5>
          </div>
          <div class="card-body">
            <form id="personalInfoForm">
              <div class="row">
                <div class="col-md-4 mb-3">
                  <label for="firstname" class="form-label">First Name</label>
                  <input
                    type="text"
                    class="form-control"
                    id="firstname"
                    required
                  />
                </div>
                <div class="col-md-4 mb-3">
                  <label for="middlename" class="form-label">Middle Name</label>
                  <input type="text" class="form-control" id="middlename" />
                </div>
                <div class="col-md-4 mb-3">
                  <label for="lastname" class="form-label">Last Name</label>
                  <input
                    type="text"
                    class="form-control"
                    id="lastname"
                    required
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-md-4 mb-3">
                  <label for="email" class="form-label">Email</label>
                  <input type="email" class="form-control" id="email" />
                </div>
                <div class="col-md-4 mb-3">
                  <label for="phone" class="form-label">Phone</label>
                  <input type="tel" class="form-control" id="phone" />
                </div>
                <div class="col-md-4 mb-3">
                  <label for="kindred" class="form-label">Kindred</label>
                  <input
                    type="text"
                    class="form-control"
                    id="kindred"
                    readonly
                  />
                </div>
              </div>
              <div class="row">
                <div class="col-md-4 mb-3">
                  <label for="lga" class="form-label">LGA</label>
                  <input type="text" class="form-control" id="lga" readonly />
                </div>
                <div class="col-md-4 mb-3">
                  <label for="state" class="form-label">State</label>
                  <input type="text" class="form-control" id="state" readonly />
                </div>
                <div class="col-md-4 mb-3">
                  <label for="role" class="form-label">Role</label>
                  <input
                    type="text"
                    class="form-control"
                    id="role"
                    readonly
                    value="Kindred Head"
                  />
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Settings Page -->
      <div id="settings-page" class="page-content d-none">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="mb-0">Settings & Security</h2>
        </div>

        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">Settings</li>
          </ol>
        </nav>

        <!-- Security Settings -->
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="mb-0">Security Settings</h5>
          </div>
          <div class="card-body">
            <div class="mb-3">
              <h6>Two-Factor Authentication</h6>
              <div class="d-flex align-items-center">
                <div class="form-check form-switch me-3">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="settingsTwoFactorToggle"
                  />
                  <label class="form-check-label" for="settingsTwoFactorToggle">
                    Enable Two-Factor Authentication
                  </label>
                </div>
                <button
                  class="btn btn-outline-primary"
                  id="generateBackupCodes"
                >
                  <i class="bi bi-shield-lock me-2"></i>Generate Backup Codes
                </button>
              </div>
            </div>

            <div class="mb-3">
              <h6>Password</h6>
              <button
                class="btn btn-outline-primary"
                data-bs-toggle="modal"
                data-bs-target="#changePasswordModal"
              >
                <i class="bi bi-key me-2"></i>Change Password
              </button>
            </div>

            <div class="mb-3">
              <h6>Backup Codes</h6>
              <div id="backupCodesContainer" class="d-none">
                <div class="alert alert-info">
                  <p class="mb-2">
                    Save these backup codes in a safe place. You can use them to
                    access your account if you lose access to your
                    authentication device.
                  </p>
                  <div class="row" id="backupCodesList">
                    <!-- Backup codes will be populated here -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Notification Settings -->
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="mb-0">Notification Settings</h5>
          </div>
          <div class="card-body">
            <div class="form-check form-switch mb-3">
              <input
                class="form-check-input"
                type="checkbox"
                id="emailNotifications"
                checked
              />
              <label class="form-check-label" for="emailNotifications">
                Email Notifications
              </label>
            </div>
            <div class="form-check form-switch mb-3">
              <input
                class="form-check-input"
                type="checkbox"
                id="smsNotifications"
              />
              <label class="form-check-label" for="smsNotifications">
                SMS Notifications
              </label>
            </div>
            <div class="form-check form-switch mb-3">
              <input
                class="form-check-input"
                type="checkbox"
                id="pushNotifications"
                checked
              />
              <label class="form-check-label" for="pushNotifications">
                Push Notifications
              </label>
            </div>
          </div>
        </div>

        <!-- Privacy Settings -->
        <div class="card">
          <div class="card-header">
            <h5 class="mb-0">Privacy Settings</h5>
          </div>
          <div class="card-body">
            <div class="form-check form-switch mb-3">
              <input
                class="form-check-input"
                type="checkbox"
                id="profileVisibility"
                checked
              />
              <label class="form-check-label" for="profileVisibility">
                Make Profile Public
              </label>
            </div>
            <div class="form-check form-switch mb-3">
              <input
                class="form-check-input"
                type="checkbox"
                id="showContactInfo"
              />
              <label class="form-check-label" for="showContactInfo">
                Show Contact Information
              </label>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- View Certificate Modal -->
    <div
      class="modal fade"
      id="viewCertificateModal"
      tabindex="-1"
      aria-labelledby="viewCertificateModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="viewCertificateModalLabel">
              Certificate Request Details
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div id="viewCertificateContent" class="p-2">
              <div class="text-center text-muted">
                <i class="bi bi-hourglass-split fs-3"></i>
                <p class="mt-2">Loading certificate details...</p>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="downloadCertificateBtn"
              style="display: none"
            >
              <i class="bi bi-download me-2"></i>Download
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Approve Certificate Modal -->
    <div
      class="modal fade"
      id="approveCertificateModal"
      tabindex="-1"
      aria-labelledby="approveCertificateModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="approveCertificateModalLabel">
              Approve Certificate Request
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to approve this certificate request?</p>
            <div class="mb-3">
              <label for="approvalComment" class="form-label"
                >Comment (Optional)</label
              >
              <textarea
                class="form-control"
                id="approvalComment"
                rows="3"
              ></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-success"
              id="confirmApproveBtn"
            >
              <i class="bi bi-check-circle me-2"></i>Approve
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Reject Certificate Modal -->
    <div
      class="modal fade"
      id="rejectCertificateModal"
      tabindex="-1"
      aria-labelledby="rejectCertificateModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="rejectCertificateModalLabel">
              Reject Certificate Request
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="rejectionReason" class="form-label"
                >Rejection Reason *</label
              >
              <textarea
                class="form-control"
                id="rejectionReason"
                rows="3"
                required
              ></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="button" class="btn btn-danger" id="confirmRejectBtn">
              <i class="bi bi-x-circle me-2"></i>Reject
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Comment Certificate Modal -->
    <div
      class="modal fade"
      id="commentCertificateModal"
      tabindex="-1"
      aria-labelledby="commentCertificateModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="commentCertificateModalLabel">
              Add Comment
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="certificateComment" class="form-label"
                >Comment *</label
              >
              <textarea
                class="form-control"
                id="certificateComment"
                rows="3"
                required
              ></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="confirmCommentBtn"
            >
              <i class="bi bi-chat-left-text me-2"></i>Add Comment
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Change Password Modal -->
    <div
      class="modal fade"
      id="changePasswordModal"
      tabindex="-1"
      aria-labelledby="changePasswordModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="changePasswordModalLabel">
              Change Password
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="changePasswordForm">
              <div class="mb-3">
                <label for="currentPassword" class="form-label"
                  >Current Password</label
                >
                <input
                  type="password"
                  class="form-control"
                  id="currentPassword"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="newPassword" class="form-label">New Password</label>
                <input
                  type="password"
                  class="form-control"
                  id="newPassword"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="confirmPassword" class="form-label"
                  >Confirm New Password</label
                >
                <input
                  type="password"
                  class="form-control"
                  id="confirmPassword"
                  required
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="changePasswordBtn"
            >
              Change Password
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
      <div
        id="successToast"
        class="toast"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
      >
        <div class="toast-header bg-success text-white">
          <i class="bi bi-check-circle-fill me-2"></i>
          <strong class="me-auto">Success</strong>
          <button
            type="button"
            class="btn-close btn-close-white"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
        <div class="toast-body" id="successToastMessage">
          Operation completed successfully.
        </div>
      </div>

      <div
        id="errorToast"
        class="toast"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
      >
        <div class="toast-header bg-danger text-white">
          <i class="bi bi-exclamation-triangle-fill me-2"></i>
          <strong class="me-auto">Error</strong>
          <button
            type="button"
            class="btn-close btn-close-white"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
        <div class="toast-body" id="errorToastMessage">
          An error occurred. Please try again.
        </div>
      </div>
    </div>

    <script>
      // Mock API data
      const mockDashboardData = {
        summary: {
          totalMembers: 42,
          totalCertificates: 118,
          pendingCertificates: 25,
          approvedCertificates: 80,
          rejectedCertificates: 13,
        },
        analytics: {
          requestsByStatus: {
            Pending: 25,
            Approved: 80,
            Rejected: 13,
          },
          requestsByDay: {
            Mon: 10,
            Tue: 15,
            Wed: 20,
            Thu: 12,
            Fri: 18,
            Sat: 25,
            Sun: 18,
          },
          topLGAs: [
            { name: "Makurdi", count: 30 },
            { name: "Gboko", count: 25 },
            { name: "Otukpo", count: 20 },
            { name: "Katsina-Ala", count: 15 },
            { name: "Vandeikya", count: 10 },
          ],
        },
        recentActivity: [
          {
            time: "2 hours ago",
            content: "Certificate request #CERT-0012 approved",
          },
          {
            time: "5 hours ago",
            content: "New certificate request #CERT-0013 submitted",
          },
          {
            time: "1 day ago",
            content: "Certificate request #CERT-0010 rejected",
          },
          {
            time: "2 days ago",
            content: "Certificate request #CERT-0009 approved",
          },
          {
            time: "3 days ago",
            content: "New member John Doe added to kindred",
          },
        ],
        profileCompletion: 85,
      };

      const mockCertificatesData = {
        all: [
          {
            id: "CERT-0013",
            name: "Aisha Bello",
            nin: "12345678901",
            phone: "08012345678",
            date: "2023-11-15",
            status: "pending",
          },
          {
            id: "CERT-0012",
            name: "David Okafor",
            nin: "23456789012",
            phone: "08023456789",
            date: "2023-11-14",
            status: "approved",
            approvalDate: "2023-11-15",
          },
          {
            id: "CERT-0011",
            name: "Grace Ibrahim",
            nin: "34567890123",
            phone: "08034567890",
            date: "2023-11-13",
            status: "rejected",
            rejectionDate: "2023-11-14",
            reason: "Incomplete documentation",
          },
          {
            id: "CERT-0010",
            name: "Samuel Eze",
            nin: "45678901234",
            phone: "08045678901",
            date: "2023-11-12",
            status: "approved",
            approvalDate: "2023-11-13",
          },
          {
            id: "CERT-0009",
            name: "Fatima Abdullahi",
            nin: "56789012345",
            phone: "08056789012",
            date: "2023-11-11",
            status: "approved",
            approvalDate: "2023-11-12",
          },
        ],
        pending: [
          {
            id: "CERT-0013",
            name: "Aisha Bello",
            nin: "12345678901",
            phone: "08012345678",
            date: "2023-11-15",
          },
        ],
        approved: [
          {
            id: "CERT-0012",
            name: "David Okafor",
            nin: "23456789012",
            phone: "08023456789",
            date: "2023-11-14",
            approvalDate: "2023-11-15",
          },
          {
            id: "CERT-0010",
            name: "Samuel Eze",
            nin: "45678901234",
            phone: "08045678901",
            date: "2023-11-12",
            approvalDate: "2023-11-13",
          },
          {
            id: "CERT-0009",
            name: "Fatima Abdullahi",
            nin: "56789012345",
            phone: "08056789012",
            date: "2023-11-11",
            approvalDate: "2023-11-12",
          },
        ],
        rejected: [
          {
            id: "CERT-0011",
            name: "Grace Ibrahim",
            nin: "34567890123",
            phone: "08034567890",
            date: "2023-11-13",
            rejectionDate: "2023-11-14",
            reason: "Incomplete documentation",
          },
        ],
      };

      const mockMembersData = [
        {
          name: "John Doe",
          nin: "12345678901",
          phone: "08012345678",
          email: "john.doe@example.com",
          address: "123 Main St, Makurdi",
          registrationDate: "2023-01-15",
        },
        {
          name: "Jane Smith",
          nin: "23456789012",
          phone: "08023456789",
          email: "jane.smith@example.com",
          address: "456 Oak Ave, Gboko",
          registrationDate: "2023-02-20",
        },
        {
          name: "Ahmed Yusuf",
          nin: "34567890123",
          phone: "08034567890",
          email: "ahmed.yusuf@example.com",
          address: "789 Pine Rd, Otukpo",
          registrationDate: "2023-03-10",
        },
        {
          name: "Grace Johnson",
          nin: "45678901234",
          phone: "08045678901",
          email: "grace.johnson@example.com",
          address: "321 Elm St, Katsina-Ala",
          registrationDate: "2023-04-05",
        },
        {
          name: "Michael Okonkwo",
          nin: "56789012345",
          phone: "08056789012",
          email: "michael.okonkwo@example.com",
          address: "654 Maple Dr, Vandeikya",
          registrationDate: "2023-05-12",
        },
      ];

      const mockActivityLogs = [
        {
          time: "2023-11-15 10:30:00",
          user: "Kindred Head",
          action: "Approved certificate request #CERT-0012",
          details: "Certificate of Origin for David Okafor",
        },
        {
          time: "2023-11-15 09:15:00",
          user: "System",
          action: "New certificate request submitted",
          details: "Certificate of Origin request #CERT-0013 by Aisha Bello",
        },
        {
          time: "2023-11-14 14:45:00",
          user: "Kindred Head",
          action: "Rejected certificate request #CERT-0011",
          details: "Reason: Incomplete documentation",
        },
        {
          time: "2023-11-14 11:20:00",
          user: "Kindred Head",
          action: "Approved certificate request #CERT-0010",
          details: "Certificate of Origin for Samuel Eze",
        },
        {
          time: "2023-11-13 16:30:00",
          user: "System",
          action: "New member added",
          details: "John Doe added to kindred",
        },
        {
          time: "2023-11-13 10:15:00",
          user: "Kindred Head",
          action: "Approved certificate request #CERT-0009",
          details: "Certificate of Origin for Fatima Abdullahi",
        },
        {
          time: "2023-11-12 13:45:00",
          user: "System",
          action: "Certificate request submitted",
          details: "Certificate of Origin request #CERT-0011 by Grace Ibrahim",
        },
        {
          time: "2023-11-12 09:30:00",
          user: "Kindred Head",
          action: "Approved certificate request #CERT-0008",
          details: "Certificate of Origin for Peter Okoro",
        },
      ];

      const mockProfileData = {
        firstname: "John",
        middlename: "Michael",
        lastname: "Doe",
        email: "john.doe@example.com",
        phone: "08012345678",
        kindred: "Adikpo",
        lga: "Kwande",
        state: "Benue",
        role: "Kindred Head",
        profileCompletion: 85,
      };

      // Global variables
      let currentCertificateId = null;
      let allCertificatesTable = null;
      let pendingCertificatesTable = null;
      let approvedCertificatesTable = null;
      let rejectedCertificatesTable = null;
      let membersTable = null;

      // Document ready function
      $(document).ready(function () {
        // Initialize theme
        initTheme();

        // Initialize dashboard
        loadDashboardData();

        // Initialize navigation
        initNavigation();

        // Initialize tables
        initTables();

        // Initialize modals
        initModals();

        // Initialize settings
        initSettings();

        // Initialize search
        initSearch();

        // Initialize notifications
        loadNotifications();
      });

      // Theme initialization
      function initTheme() {
        const savedTheme = localStorage.getItem("theme") || "light";
        if (savedTheme === "dark") {
          $("body").attr("data-theme", "dark");
          $("#themeToggle").addClass("active");
        }

        $("#themeToggle").click(function () {
          const currentTheme = $("body").attr("data-theme");
          const newTheme = currentTheme === "dark" ? "light" : "dark";

          $("body").attr("data-theme", newTheme);
          localStorage.setItem("theme", newTheme);

          if (newTheme === "dark") {
            $("#themeToggle").addClass("active");
          } else {
            $("#themeToggle").removeClass("active");
          }
        });
      }

      // Navigation initialization
      function initNavigation() {
        // Sidebar toggle for mobile
        $("#sidebarToggle").click(function () {
          $("#sidebar").toggleClass("show");
        });

        // Page navigation
        $(".sidebar-menu .nav-link").click(function (e) {
          e.preventDefault();

          const targetPage = $(this).data("page");

          // Update active nav
          $(".sidebar-menu .nav-link").removeClass("active");
          $(this).addClass("active");

          // Show target page
          $(".page-content").addClass("d-none");
          $(`#${targetPage}-page`).removeClass("d-none");

          // Load page-specific data
          switch (targetPage) {
            case "dashboard":
              loadDashboardData();
              break;
            case "certificates":
              loadCertificatesData();
              break;
            case "analytics":
              loadAnalyticsData();
              break;
            case "members":
              loadMembersData();
              break;
            case "activity":
              loadActivityLogs();
              break;
            case "profile":
              loadProfileData();
              break;
          }
        });
      }

      // Dashboard data loading
      function loadDashboardData() {
        // showLoadingSpinner();

        // Simulate API call
        setTimeout(function () {
          // Update summary cards
          $("#totalMembersCard").text(mockDashboardData.summary.totalMembers);
          $("#totalCertificatesCard").text(
            mockDashboardData.summary.totalCertificates
          );
          $("#pendingCertificatesCard").text(
            mockDashboardData.summary.pendingCertificates
          );
          $("#approvedCertificatesCard").text(
            mockDashboardData.summary.approvedCertificates
          );

          // Update badges
          $("#pendingCertificatesBadge").text(
            mockDashboardData.summary.pendingCertificates
          );
          $("#pendingCount").text(
            mockDashboardData.summary.pendingCertificates
          );

          // Update profile completion
          $("#profileCompletionBadge").text(
            mockDashboardData.profileCompletion + "%"
          );
          $("#profileCompletionText").text(
            mockDashboardData.profileCompletion + "%"
          );
          $("#profileCompletionBar").css(
            "width",
            mockDashboardData.profileCompletion + "%"
          );

          // Update activity timeline
          updateActivityTimeline(mockDashboardData.recentActivity);

          // Initialize charts
          initDashboardCharts();

          hideLoadingSpinner();
        }, 500);
      }

      // Initialize dashboard charts
      function initDashboardCharts() {
        // Request Status Chart
        const statusCtx = document
          .getElementById("requestStatusChart")
          .getContext("2d");
        new Chart(statusCtx, {
          type: "pie",
          data: {
            labels: Object.keys(mockDashboardData.analytics.requestsByStatus),
            datasets: [
              {
                data: Object.values(
                  mockDashboardData.analytics.requestsByStatus
                ),
                backgroundColor: ["#f59e0b", "#10b981", "#ef4444"],
                borderWidth: 0,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: "bottom",
              },
            },
          },
        });

        // Request Frequency Chart
        const frequencyCtx = document
          .getElementById("requestFrequencyChart")
          .getContext("2d");
        new Chart(frequencyCtx, {
          type: "bar",
          data: {
            labels: Object.keys(mockDashboardData.analytics.requestsByDay),
            datasets: [
              {
                label: "Requests",
                data: Object.values(mockDashboardData.analytics.requestsByDay),
                backgroundColor: "#4c5fd5",
                borderWidth: 0,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
              },
            },
            plugins: {
              legend: {
                display: false,
              },
            },
          },
        });

        // Top LGAs Chart
        const lgaCtx = document.getElementById("topLGAsChart").getContext("2d");
        new Chart(lgaCtx, {
          type: "horizontalBar",
          data: {
            labels: mockDashboardData.analytics.topLGAs.map((lga) => lga.name),
            datasets: [
              {
                label: "Requests",
                data: mockDashboardData.analytics.topLGAs.map(
                  (lga) => lga.count
                ),
                backgroundColor: "#3b82f6",
                borderWidth: 0,
              },
            ],
          },
          options: {
            indexAxis: "y",
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              x: {
                beginAtZero: true,
              },
            },
            plugins: {
              legend: {
                display: false,
              },
            },
          },
        });
      }

      // Update activity timeline
      function updateActivityTimeline(activities) {
        const timeline = $("#activityTimeline");
        timeline.empty();

        activities.forEach((activity) => {
          const item = $(`
            <div class="activity-item animate__animated animate__fadeIn">
              <div class="activity-time">${activity.time}</div>
              <div class="activity-content">${activity.content}</div>
            </div>
          `);
          timeline.append(item);
        });
      }

      // Tables initialization
      function initTables() {
        // All Certificates Table
        allCertificatesTable = $("#allCertificatesTable").DataTable({
          data: mockCertificatesData.all,
          columns: [
            { data: "id" },
            { data: "name" },
            { data: "nin" },
            { data: "phone" },
            { data: "date" },
            {
              data: "status",
              render: function (data) {
                let badgeClass = "";
                switch (data) {
                  case "pending":
                    badgeClass = "pending";
                    break;
                  case "approved":
                    badgeClass = "approved";
                    break;
                  case "rejected":
                    badgeClass = "rejected";
                    break;
                }
                return `<span class="status-badge ${badgeClass}">${
                  data.charAt(0).toUpperCase() + data.slice(1)
                }</span>`;
              },
            },
            {
              data: null,
              render: function (data, type, row) {
                return `
                  <div class="btn-group" role="group">
                    <button type="button" class="btn btn-sm btn-outline-primary view-certificate" data-id="${
                      row.id
                    }">
                      <i class="bi bi-eye"></i>
                    </button>
                    ${
                      row.status === "pending"
                        ? `
                      <button type="button" class="btn btn-sm btn-outline-success approve-certificate" data-id="${row.id}">
                        <i class="bi bi-check"></i>
                      </button>
                      <button type="button" class="btn btn-sm btn-outline-danger reject-certificate" data-id="${row.id}">
                        <i class="bi bi-x"></i>
                      </button>
                    `
                        : ""
                    }
                    <button type="button" class="btn btn-sm btn-outline-info comment-certificate" data-id="${
                      row.id
                    }">
                      <i class="bi bi-chat"></i>
                    </button>
                  </div>
                `;
              },
            },
          ],
          responsive: true,
          dom: "Bfrtip",
          buttons: ["copy", "csv", "excel", "pdf", "print"],
        });

        // Pending Certificates Table
        pendingCertificatesTable = $("#pendingCertificatesTable").DataTable({
          data: mockCertificatesData.pending,
          columns: [
            { data: "id" },
            { data: "name" },
            { data: "nin" },
            { data: "phone" },
            { data: "date" },
            {
              data: null,
              render: function (data, type, row) {
                return `
                  <div class="btn-group" role="group">
                    <button type="button" class="btn btn-sm btn-outline-primary view-certificate" data-id="${row.id}">
                      <i class="bi bi-eye"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-success approve-certificate" data-id="${row.id}">
                      <i class="bi bi-check"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-danger reject-certificate" data-id="${row.id}">
                      <i class="bi bi-x"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-info comment-certificate" data-id="${row.id}">
                      <i class="bi bi-chat"></i>
                    </button>
                  </div>
                `;
              },
            },
          ],
          responsive: true,
        });

        // Approved Certificates Table
        approvedCertificatesTable = $("#approvedCertificatesTable").DataTable({
          data: mockCertificatesData.approved,
          columns: [
            { data: "id" },
            { data: "name" },
            { data: "nin" },
            { data: "phone" },
            { data: "date" },
            { data: "approvalDate" },
            {
              data: null,
              render: function (data, type, row) {
                return `
                  <div class="btn-group" role="group">
                    <button type="button" class="btn btn-sm btn-outline-primary view-certificate" data-id="${row.id}">
                      <i class="bi bi-eye"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-info comment-certificate" data-id="${row.id}">
                      <i class="bi bi-chat"></i>
                    </button>
                  </div>
                `;
              },
            },
          ],
          responsive: true,
        });

        // Rejected Certificates Table
        rejectedCertificatesTable = $("#rejectedCertificatesTable").DataTable({
          data: mockCertificatesData.rejected,
          columns: [
            { data: "id" },
            { data: "name" },
            { data: "nin" },
            { data: "phone" },
            { data: "date" },
            { data: "rejectionDate" },
            { data: "reason" },
            {
              data: null,
              render: function (data, type, row) {
                return `
                  <div class="btn-group" role="group">
                    <button type="button" class="btn btn-sm btn-outline-primary view-certificate" data-id="${row.id}">
                      <i class="bi bi-eye"></i>
                    </button>
                    <button type="button" class="btn btn-sm btn-outline-info comment-certificate" data-id="${row.id}">
                      <i class="bi bi-chat"></i>
                    </button>
                  </div>
                `;
              },
            },
          ],
          responsive: true,
        });

        // Members Table
        membersTable = $("#membersTable").DataTable({
          data: mockMembersData,
          columns: [
            { data: "name" },
            { data: "nin" },
            { data: "phone" },
            { data: "email" },
            { data: "address" },
            { data: "registrationDate" },
            {
              data: null,
              render: function (data, type, row) {
                return `
                  <div class="btn-group" role="group">
                    <button type="button" class="btn btn-sm btn-outline-primary view-member" data-id="${row.nin}">
                      <i class="bi bi-eye"></i>
                    </button>
                  </div>
                `;
              },
            },
          ],
          responsive: true,
          dom: "Bfrtip",
          buttons: ["copy", "csv", "excel", "pdf", "print"],
        });

        // Certificate action buttons
        $(document).on("click", ".view-certificate", function () {
          const certificateId = $(this).data("id");
          viewCertificate(certificateId);
        });

        $(document).on("click", ".approve-certificate", function () {
          const certificateId = $(this).data("id");
          approveCertificate(certificateId);
        });

        $(document).on("click", ".reject-certificate", function () {
          const certificateId = $(this).data("id");
          rejectCertificate(certificateId);
        });

        $(document).on("click", ".comment-certificate", function () {
          const certificateId = $(this).data("id");
          commentCertificate(certificateId);
        });
      }

      // Load certificates data
      function loadCertificatesData() {
        showLoadingSpinner();

        // Simulate API call
        setTimeout(function () {
          // Tables are already initialized with data
          hideLoadingSpinner();
        }, 500);
      }

      // Load analytics data
      function loadAnalyticsData() {
        showLoadingSpinner();

        // Simulate API call
        setTimeout(function () {
          // Initialize analytics charts
          initAnalyticsCharts();
          hideLoadingSpinner();
        }, 500);
      }

      // Initialize analytics charts
      function initAnalyticsCharts() {
        // Certificate Trend Chart
        const trendCtx = document
          .getElementById("certificateTrendChart")
          .getContext("2d");
        new Chart(trendCtx, {
          type: "line",
          data: {
            labels: [
              "Jan",
              "Feb",
              "Mar",
              "Apr",
              "May",
              "Jun",
              "Jul",
              "Aug",
              "Sep",
              "Oct",
              "Nov",
              "Dec",
            ],
            datasets: [
              {
                label: "Certificate Requests",
                data: [12, 19, 15, 25, 22, 30, 28, 35, 32, 40, 38, 45],
                borderColor: "#4c5fd5",
                backgroundColor: "rgba(76, 95, 213, 0.1)",
                tension: 0.4,
                fill: true,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
              },
            },
          },
        });

        // Approval Rate Chart
        const approvalCtx = document
          .getElementById("approvalRateChart")
          .getContext("2d");
        new Chart(approvalCtx, {
          type: "doughnut",
          data: {
            labels: ["Approved", "Rejected", "Pending"],
            datasets: [
              {
                data: [80, 13, 25],
                backgroundColor: ["#10b981", "#ef4444", "#f59e0b"],
                borderWidth: 0,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: "bottom",
              },
            },
          },
        });

        // Requests by Kindred Chart
        const kindredCtx = document
          .getElementById("requestsByKindredChart")
          .getContext("2d");
        new Chart(kindredCtx, {
          type: "bar",
          data: {
            labels: ["Adikpo", "Ikyogen", "Ushongo", "Ugam", "Yaaku"],
            datasets: [
              {
                label: "Requests",
                data: [30, 25, 20, 15, 10],
                backgroundColor: "#3b82f6",
                borderWidth: 0,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
              },
            },
            plugins: {
              legend: {
                display: false,
              },
            },
          },
        });

        // Processing Time Chart
        const processingCtx = document
          .getElementById("processingTimeChart")
          .getContext("2d");
        new Chart(processingCtx, {
          type: "line",
          data: {
            labels: [
              "Jan",
              "Feb",
              "Mar",
              "Apr",
              "May",
              "Jun",
              "Jul",
              "Aug",
              "Sep",
              "Oct",
              "Nov",
              "Dec",
            ],
            datasets: [
              {
                label: "Average Processing Time (Days)",
                data: [
                  3.5, 3.2, 2.8, 2.5, 2.3, 2.1, 2.0, 1.8, 1.7, 1.5, 1.4, 1.3,
                ],
                borderColor: "#10b981",
                backgroundColor: "rgba(16, 185, 129, 0.1)",
                tension: 0.4,
                fill: true,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
              },
            },
          },
        });
      }

      // Load members data
      function loadMembersData() {
        showLoadingSpinner();

        // Simulate API call
        setTimeout(function () {
          // Table is already initialized with data
          hideLoadingSpinner();
        }, 500);
      }

      // Load activity logs
      function loadActivityLogs() {
        showLoadingSpinner();

        // Simulate API call
        setTimeout(function () {
          const timeline = $("#fullActivityTimeline");
          timeline.empty();

          mockActivityLogs.forEach((activity) => {
            const item = $(`
              <div class="activity-item animate__animated animate__fadeIn">
                <div class="activity-time">${activity.time}</div>
                <div class="activity-content">
                  <strong>${activity.user}</strong> ${activity.action}
                  <div class="text-muted small mt-1">${activity.details}</div>
                </div>
              </div>
            `);
            timeline.append(item);
          });

          hideLoadingSpinner();
        }, 500);
      }

      // Load profile data
      function loadProfileData() {
        showLoadingSpinner();

        // Simulate API call
        setTimeout(function () {
          // Update profile form
          $("#firstname").val(mockProfileData.firstname);
          $("#middlename").val(mockProfileData.middlename);
          $("#lastname").val(mockProfileData.lastname);
          $("#email").val(mockProfileData.email);
          $("#phone").val(mockProfileData.phone);
          $("#kindred").val(mockProfileData.kindred);
          $("#lga").val(mockProfileData.lga);
          $("#state").val(mockProfileData.state);
          $("#role").val(mockProfileData.role);

          // Update profile completion
          $("#profileCompletionText").text(
            mockProfileData.profileCompletion + "%"
          );
          $("#profileCompletionBar").css(
            "width",
            mockProfileData.profileCompletion + "%"
          );

          hideLoadingSpinner();
        }, 500);
      }

      // View certificate
      function viewCertificate(certificateId) {
        currentCertificateId = certificateId;

        // Show loading state
        $("#viewCertificateContent").html(`
          <div class="text-center text-muted">
            <i class="bi bi-hourglass-split fs-3"></i>
            <p class="mt-2">Loading certificate details...</p>
          </div>
        `);

        // Show modal
        $("#viewCertificateModal").modal("show");

        // Simulate API call
        setTimeout(function () {
          // Find certificate data
          const certificate = mockCertificatesData.all.find(
            (c) => c.id === certificateId
          );

          if (certificate) {
            // Update modal content
            $("#viewCertificateContent").html(`
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label">Request ID</label>
                  <p class="form-control-plaintext">${certificate.id}</p>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label">Status</label>
                  <p><span class="status-badge ${certificate.status}">${
              certificate.status.charAt(0).toUpperCase() +
              certificate.status.slice(1)
            }</span></p>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label">Applicant Name</label>
                  <p class="form-control-plaintext">${certificate.name}</p>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label">NIN</label>
                  <p class="form-control-plaintext">${certificate.nin}</p>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label">Phone</label>
                  <p class="form-control-plaintext">${certificate.phone}</p>
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label">Request Date</label>
                  <p class="form-control-plaintext">${certificate.date}</p>
                </div>
              </div>
              ${
                certificate.approvalDate
                  ? `
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Approval Date</label>
                    <p class="form-control-plaintext">${certificate.approvalDate}</p>
                  </div>
                </div>
              `
                  : ""
              }
              ${
                certificate.rejectionDate
                  ? `
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Rejection Date</label>
                    <p class="form-control-plaintext">${certificate.rejectionDate}</p>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Rejection Reason</label>
                    <p class="form-control-plaintext">${certificate.reason}</p>
                  </div>
                </div>
              `
                  : ""
              }
              <div class="row">
                <div class="col-12 mb-3">
                  <label class="form-label">Attached Documents</label>
                  <div class="d-flex gap-2">
                    <button class="btn btn-sm btn-outline-primary">
                      <i class="bi bi-file-earmark-pdf me-1"></i>Passport Photo
                    </button>
                    <button class="btn btn-sm btn-outline-primary">
                      <i class="bi bi-file-earmark-pdf me-1"></i>ID Card
                    </button>
                    <button class="btn btn-sm btn-outline-primary">
                      <i class="bi bi-file-earmark-pdf me-1"></i>Birth Certificate
                    </button>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-12 mb-3">
                  <label class="form-label">Comments</label>
                  <div class="border rounded p-3 bg-light">
                    <div class="mb-2">
                      <strong>Kindred Head</strong> - ${new Date().toLocaleDateString()}
                      <p class="mb-0">Certificate request is being processed.</p>
                    </div>
                  </div>
                </div>
              </div>
            `);

            // Show download button for approved certificates
            if (certificate.status === "approved") {
              $("#downloadCertificateBtn").show();
            } else {
              $("#downloadCertificateBtn").hide();
            }
          }
        }, 500);
      }

      // Approve certificate
      function approveCertificate(certificateId) {
        currentCertificateId = certificateId;
        $("#approvalComment").val("");
        $("#approveCertificateModal").modal("show");
      }

      // Reject certificate
      function rejectCertificate(certificateId) {
        currentCertificateId = certificateId;
        $("#rejectionReason").val("");
        $("#rejectCertificateModal").modal("show");
      }

      // Comment on certificate
      function commentCertificate(certificateId) {
        currentCertificateId = certificateId;
        $("#certificateComment").val("");
        $("#commentCertificateModal").modal("show");
      }

      // Initialize modals
      function initModals() {
        // Confirm approve button
        $("#confirmApproveBtn").click(function () {
          const comment = $("#approvalComment").val();

          // Simulate API call
          showLoadingSpinner();

          setTimeout(function () {
            // Update certificate status in mock data
            const certificate = mockCertificatesData.all.find(
              (c) => c.id === currentCertificateId
            );
            if (certificate) {
              certificate.status = "approved";
              certificate.approvalDate = new Date().toISOString().split("T")[0];
            }

            // Remove from pending and add to approved
            const pendingIndex = mockCertificatesData.pending.findIndex(
              (c) => c.id === currentCertificateId
            );
            if (pendingIndex !== -1) {
              const cert = mockCertificatesData.pending.splice(
                pendingIndex,
                1
              )[0];
              cert.status = "approved";
              cert.approvalDate = new Date().toISOString().split("T")[0];
              mockCertificatesData.approved.push(cert);
            }

            // Refresh tables
            allCertificatesTable
              .clear()
              .rows.add(mockCertificatesData.all)
              .draw();
            pendingCertificatesTable
              .clear()
              .rows.add(mockCertificatesData.pending)
              .draw();
            approvedCertificatesTable
              .clear()
              .rows.add(mockCertificatesData.approved)
              .draw();

            // Update dashboard
            loadDashboardData();

            // Show success message
            showSuccessToast("Certificate request approved successfully.");

            // Close modal
            $("#approveCertificateModal").modal("hide");

            hideLoadingSpinner();
          }, 1000);
        });

        // Confirm reject button
        $("#confirmRejectBtn").click(function () {
          const reason = $("#rejectionReason").val();

          if (!reason) {
            $("#rejectionReason").addClass("is-invalid");
            return;
          }

          // Simulate API call
          showLoadingSpinner();

          setTimeout(function () {
            // Update certificate status in mock data
            const certificate = mockCertificatesData.all.find(
              (c) => c.id === currentCertificateId
            );
            if (certificate) {
              certificate.status = "rejected";
              certificate.rejectionDate = new Date()
                .toISOString()
                .split("T")[0];
              certificate.reason = reason;
            }

            // Remove from pending and add to rejected
            const pendingIndex = mockCertificatesData.pending.findIndex(
              (c) => c.id === currentCertificateId
            );
            if (pendingIndex !== -1) {
              const cert = mockCertificatesData.pending.splice(
                pendingIndex,
                1
              )[0];
              cert.status = "rejected";
              cert.rejectionDate = new Date().toISOString().split("T")[0];
              cert.reason = reason;
              mockCertificatesData.rejected.push(cert);
            }

            // Refresh tables
            allCertificatesTable
              .clear()
              .rows.add(mockCertificatesData.all)
              .draw();
            pendingCertificatesTable
              .clear()
              .rows.add(mockCertificatesData.pending)
              .draw();
            rejectedCertificatesTable
              .clear()
              .rows.add(mockCertificatesData.rejected)
              .draw();

            // Update dashboard
            loadDashboardData();

            // Show success message
            showSuccessToast("Certificate request rejected successfully.");

            // Close modal
            $("#rejectCertificateModal").modal("hide");

            hideLoadingSpinner();
          }, 1000);
        });

        // Confirm comment button
        $("#confirmCommentBtn").click(function () {
          const comment = $("#certificateComment").val();

          if (!comment) {
            $("#certificateComment").addClass("is-invalid");
            return;
          }

          // Simulate API call
          showLoadingSpinner();

          setTimeout(function () {
            // Show success message
            showSuccessToast("Comment added successfully.");

            // Close modal
            $("#commentCertificateModal").modal("hide");

            hideLoadingSpinner();
          }, 500);
        });

        // Download certificate button
        $("#downloadCertificateBtn").click(function () {
          // Simulate download
          showSuccessToast("Certificate downloaded successfully.");
        });

        // Change password form
        $("#changePasswordBtn").click(function () {
          const currentPassword = $("#currentPassword").val();
          const newPassword = $("#newPassword").val();
          const confirmPassword = $("#confirmPassword").val();

          if (!currentPassword || !newPassword || !confirmPassword) {
            showErrorToast("Please fill in all fields.");
            return;
          }

          if (newPassword !== confirmPassword) {
            showErrorToast("New password and confirmation do not match.");
            return;
          }

          // Simulate API call
          showLoadingSpinner();

          setTimeout(function () {
            // Show success message
            showSuccessToast("Password changed successfully.");

            // Close modal
            $("#changePasswordModal").modal("hide");

            // Clear form
            $("#changePasswordForm")[0].reset();

            hideLoadingSpinner();
          }, 1000);
        });

        // Generate backup codes
        $("#generateBackupCodes").click(function () {
          // Generate random backup codes
          const codes = [];
          for (let i = 0; i < 8; i++) {
            codes.push(
              Math.random().toString(36).substring(2, 10).toUpperCase()
            );
          }

          // Display codes
          const codesList = $("#backupCodesList");
          codesList.empty();

          codes.forEach((code) => {
            codesList.append(`
              <div class="col-6 mb-2">
                <div class="border rounded p-2 text-center">${code}</div>
              </div>
            `);
          });

          // Show container
          $("#backupCodesContainer").removeClass("d-none");
        });

        // Save profile button
        $("#saveProfileBtn").click(function () {
          // Get form data
          const profileData = {
            firstname: $("#firstname").val(),
            middlename: $("#middlename").val(),
            lastname: $("#lastname").val(),
            email: $("#email").val(),
            phone: $("#phone").val(),
          };

          // Simulate API call
          showLoadingSpinner();

          setTimeout(function () {
            // Update mock data
            Object.assign(mockProfileData, profileData);

            // Show success message
            showSuccessToast("Profile updated successfully.");

            hideLoadingSpinner();
          }, 1000);
        });
      }

      // Initialize settings
      function initSettings() {
        // Two-factor toggle
        $("#twoFactorToggle, #settingsTwoFactorToggle").change(function () {
          const isEnabled = $(this).is(":checked");
          $("#twoFactorStatus").text(isEnabled ? "Enabled" : "Disabled");

          // Simulate API call
          showLoadingSpinner();

          setTimeout(function () {
            // Show success message
            showSuccessToast(
              `Two-factor authentication ${
                isEnabled ? "enabled" : "disabled"
              } successfully.`
            );

            hideLoadingSpinner();
          }, 500);
        });

        // Logout button
        $("#logoutBtn").click(function (e) {
          e.preventDefault();

          // Simulate logout
          showLoadingSpinner();

          setTimeout(function () {
            // Redirect to login page
            window.location.href = "/login";
          }, 1000);
        });

        // Refresh buttons
        $(
          "#refreshDashboard, #refreshCertificates, #refreshAnalytics, #refreshMembers, #refreshActivity"
        ).click(function () {
          // Get current page
          const currentPage = $(".page-content:not(.d-none)")
            .attr("id")
            .replace("-page", "");

          // Reload page data
          switch (currentPage) {
            case "dashboard":
              loadDashboardData();
              break;
            case "certificates":
              loadCertificatesData();
              break;
            case "analytics":
              loadAnalyticsData();
              break;
            case "members":
              loadMembersData();
              break;
            case "activity":
              loadActivityLogs();
              break;
          }
        });

        // Export buttons
        $("#exportCertificates, #exportMembers").click(function () {
          showSuccessToast("Data exported successfully.");
        });
      }

      // Initialize search
      function initSearch() {
        $("#globalSearch").on("input", function () {
          const searchTerm = $(this).val().toLowerCase();

          // Search in certificates table if on certificates page
          if (!$("#certificates-page").hasClass("d-none")) {
            allCertificatesTable.search(searchTerm).draw();
          }

          // Search in members table if on members page
          if (!$("#members-page").hasClass("d-none")) {
            membersTable.search(searchTerm).draw();
          }
        });
      }

      // Load notifications
      function loadNotifications() {
        // Simulate API call
        setTimeout(function () {
          // Get pending certificates count
          const pendingCount = mockDashboardData.summary.pendingCertificates;

          // Update notification badge
          $("#notificationCount").text(pendingCount);

          // Update notifications list
          if (pendingCount > 0) {
            $("#noNotifications").hide();

            const container = $("#notificationsContainer");
            container.empty();

            // Add notification for each pending certificate
            mockCertificatesData.pending.forEach((cert) => {
              const notification = $(`
                <li>
                  <a href="#" class="dropdown-item py-3" data-page="certificates">
                    <div class="d-flex">
                      <div class="flex-shrink-0">
                        <i class="bi bi-exclamation-triangle-fill text-warning fs-5"></i>
                      </div>
                      <div class="flex-grow-1 ms-3">
                        <h6 class="mb-1">Pending Certificate Request</h6>
                        <p class="mb-1 small">Certificate request ${cert.id} by ${cert.name} is pending approval.</p>
                        <p class="mb-0 small text-muted">${cert.date}</p>
                      </div>
                    </div>
                  </a>
                </li>
              `);
              container.append(notification);
            });
          } else {
            $("#noNotifications").show();
          }

          // Handle notification clicks
          $("#notificationsContainer a").click(function (e) {
            e.preventDefault();

            const targetPage = $(this).data("page");

            // Navigate to target page
            $(`.sidebar-menu .nav-link[data-page="${targetPage}"]`).click();
          });
        }, 500);
      }

      // Show loading spinner
      function showLoadingSpinner() {
        $("#loadingSpinner").addClass("show");
      }

      // Hide loading spinner
      function hideLoadingSpinner() {
        $("#loadingSpinner").removeClass("show");
      }

      // Show success toast
      function showSuccessToast(message) {
        $("#successToastMessage").text(message);
        const toast = new bootstrap.Toast(
          document.getElementById("successToast")
        );
        toast.show();
      }

      // Show error toast
      function showErrorToast(message) {
        $("#errorToastMessage").text(message);
        const toast = new bootstrap.Toast(
          document.getElementById("errorToast")
        );
        toast.show();
      }
    </script>
  </body>
</html>
